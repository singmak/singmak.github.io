{"componentChunkName":"component---src-pages-post-mdx-slug-tsx","path":"/post/2021-5-30-serverless-manage-resources/","result":{"data":{"mdx":{"frontmatter":{"title":"Managing CloudFormation stack with Serverless Framework","date":"May 30, 2021","description":"Serverless Framework support Cloudformation syntax in serverless.yml. You can add new resources and override / modify the resources generated by Serverless in serverless.yml."},"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Managing CloudFormation stack with Serverless Framework\",\n  \"date\": \"2021-05-30\",\n  \"description\": \"Serverless Framework support Cloudformation syntax in serverless.yml. You can add new resources and override / modify the resources generated by Serverless in serverless.yml.\",\n  \"tags\": [\"aws\", \"lambda\", \"serverless\", \"cloudformation\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"It's easy to create a AWS Lambda service with Serverless Framework. We just need to write the serverless.yml and Serverless Framework can use the serverless.yml properties to generate the infrastructure resources that the AWS Lambda functions depend on. Basically, if the provider in the serverless.yml is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"aws\"), \", the Serverless Framework Service is a Cloudformation stack. Serverless Framework support Cloudformation syntax in serverless.yml. You can add new resources and override / modify the resources generated by Serverless in serverless.yml.\"), mdx(\"h2\", null, \"Adding new resources\"), mdx(\"p\", null, \"It's straightforward to add new resources. You just need to add the resources under the resources -> Resources sections. The resources can be defined in CloudFormation template syntax.\\nYou can add any resources that your Lambda functions needs in this section. It can be a DynamoDb table, an S3 bucket.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yml\"\n  }, \"resources:\\n  Resources:\\n    usersTable:\\n      Type: AWS::DynamoDB::Table\\n      Properties:\\n        TableName: usersTable\\n        AttributeDefinitions:\\n          - AttributeName: email\\n            AttributeType: S\\n        KeySchema:\\n          - AttributeName: email\\n            KeyType: HASH\\n        ProvisionedThroughput:\\n          ReadCapacityUnits: 1\\n          WriteCapacityUnits: 1\\n\")), mdx(\"h2\", null, \"The Serverless Framework generated resources\"), mdx(\"p\", null, \"There are many cases that we need to reference the Serverless Framework generated resources in provisioning addition resources. All the resource names are generated based on name templates documented in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"The Serverless Framework generated resources\"), \" in \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.serverless.com/framework/docs/providers/aws/guide/resources/\"\n  }, \"https://www.serverless.com/framework/docs/providers/aws/guide/resources/\"), \"\\nOne example copied from the documentation:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"When you override basic resources, there are two things to keep in mind when it comes to normalizedFunctionName:\\n\\nIt should start with an uppercase character\\nThe - will be changed to Dash, _ will be changed to Underscore\\n\")), mdx(\"p\", null, \"so the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"normalizedFunctionName\"), \" of a function named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"write-port\"), \" in the serverless.yml will be \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"WriteDashPost\"), \".\"), mdx(\"h2\", null, \"Depending on the Serverless Framework generated resources\"), mdx(\"p\", null, \"We can create resources that depend on the resources that are generated by Serverless Framework.\"), mdx(\"p\", null, \"For example here we are adding a Gateway Response resource to the generated Rest Api \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ApiGatewayRestApi\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yml\"\n  }, \"GatewayResponseDefault4XX:\\n  Type: 'AWS::ApiGateway::GatewayResponse'\\n  Properties:\\n    ResponseParameters:\\n      gatewayresponse.header.Access-Control-Allow-Origin: \\\"'*'\\\"\\n      gatewayresponse.header.Access-Control-Allow-Headers: \\\"'*'\\\"\\n    ResponseType: DEFAULT_4XX\\n    RestApiId:\\n      Ref: 'ApiGatewayRestApi'\\n\")), mdx(\"p\", null, \"Another example, adding an API mapping to the generated \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ApiGatewayDeployment${sls:instanceId}\"), \" resource.\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"DependsOn\"), \" is used since this resource can only be created after \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ApiGatewayDeployment${sls:instanceId}\"), \" being created.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yml\"\n  }, \"UserApiMapping:\\n  Type: AWS::ApiGatewayV2::ApiMapping\\n  DependsOn: ApiGatewayDeployment${sls:instanceId}\\n  Properties: \\n    ApiId:\\n      Ref: ApiGatewayRestApi\\n    ApiMappingKey: users\\n    DomainName: api-${self:provider.stage}.sing-example.com\\n    Stage: ${self:provider.stage}\\n\")), mdx(\"h2\", null, \"Override Serverless Framework resources\"), mdx(\"p\", null, \"Serverless Framwork has a \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.serverless.com/framework/docs/providers/aws/guide/resources/#override-aws-cloudformation-resource\"\n  }, \"detailed documentation\"), \" about how to override Serverless Framework generated resources.\"));\n}\n;\nMDXContent.isMDXComponent = true;"}},"pageContext":{"id":"49a57f4c-edc6-53a6-af12-9d2f23c5b432","slug":"2021-5-30-serverless-manage-resources","__params":{"slug":"2021-5-30-serverless-manage-resources"}}},"staticQueryHashes":["3159585216"]}