<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta data-react-helmet="true" name="google-site-verification" content="0BOaKw-N8goBTlYnHzJWtb6Yn_4GeZjZHaVxq_RmV3E"/><meta data-react-helmet="true" charSet="utf-8"/><meta data-react-helmet="true" name="viewport" content="initial-scale=1, width=device-width"/><meta name="generator" content="Gatsby 4.5.4"/><style data-href="/styles.6ed856706c4e7f2d4814.css" data-identity="gatsby-global-css">a{color:#1976d2}a:hover{color:#004ba0}</style><style data-emotion="css-global 1mskswx">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css 16w95pb 3v8va9 1qsxih2 8p5sgb 1vo0z3w a9n7s9 k6h796 130f8nx 1n99ejb 11kqkkz vubbuv 1j414uv 18l9x7f 1wxaqej r4jyxi 1yxmbwk vooagt 66wxz3 17c40ea eud0j5 d404y7 1nevh8s c6r19y v2arnj 3qcq41">.css-16w95pb{background-color:#e6f1f3;min-height:100vh;}.css-3v8va9{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:0px 3px 5px -1px rgba(0,0,0,0.2),0px 5px 8px 0px rgba(0,0,0,0.14),0px 1px 14px 0px rgba(0,0,0,0.12);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:-webkit-sticky;position:sticky;z-index:1100;top:0;left:auto;right:0;background-color:#456679;color:#fff;}.css-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1qsxih2{max-width:1200px;}}.css-8p5sgb{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:56px;}@media (min-width:0px) and (orientation: landscape){.css-8p5sgb{min-height:48px;}}@media (min-width:600px){.css-8p5sgb{min-height:64px;}}.css-1vo0z3w{margin:0;font-family:Merriweather,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;text-transform:uppercase;color:rgba(0, 0, 0, 0.87);-webkit-text-decoration:none;text-decoration:none;margin-right:8px;}.css-a9n7s9{margin-left:auto;margin-right:auto;}.css-k6h796{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;color:#fff;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}@media (min-width:0px){.css-k6h796{display:none;}}@media (min-width:900px){.css-k6h796{display:block;}}@media (min-width:0px){.css-130f8nx{display:none;}}@media (min-width:600px){.css-130f8nx{display:block;}}.css-1n99ejb{margin:0;font-family:Merriweather,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;text-transform:uppercase;color:rgba(0, 0, 0, 0.87);-webkit-text-decoration:none;text-decoration:none;margin-left:20px;color:#fff;font-family:roboto;padding:5px 7px;background-color:#51748a;text-align:center;}.css-1n99ejb:hover{color:#fff;background-color:#6a889c;}.css-11kqkkz{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;sx:block;color:#fff;}.css-11kqkkz::-moz-focus-inner{border-style:none;}.css-11kqkkz.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-11kqkkz{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-11kqkkz:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-11kqkkz:hover{background-color:transparent;}}.css-11kqkkz.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}@media (min-width:600px){.css-11kqkkz{display:none;}}.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}.css-1j414uv{position:fixed;right:5px;top:200px;}@media (min-width:0px){.css-1j414uv{display:none;}}@media (min-width:900px){.css-1j414uv{display:block;}}.css-18l9x7f{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-top:-8px;width:calc(100% + 8px);margin-left:-8px;}.css-18l9x7f>.MuiGrid-item{max-width:none;}.css-18l9x7f>.MuiGrid-item{padding-top:8px;}.css-18l9x7f>.MuiGrid-item{padding-left:8px;}.css-1wxaqej{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-r4jyxi{margin:0;color:#456679;-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgba(69, 102, 121, 0.4);}.css-r4jyxi:hover{text-decoration-color:inherit;}.css-1yxmbwk{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1yxmbwk::-moz-focus-inner{border-style:none;}.css-1yxmbwk.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1yxmbwk{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1yxmbwk:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1yxmbwk:hover{background-color:transparent;}}.css-1yxmbwk.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}.css-vooagt{min-height:100vh;}.css-66wxz3{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;padding:40px;}@media (min-width:600px){.css-66wxz3{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-66wxz3{max-width:900px;}}.css-17c40ea{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;}@media (min-width:0px){.css-17c40ea{font-size:2rem;}}@media (min-width:900px){.css-17c40ea{font-size:2.5rem;}}.css-eud0j5{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;}.css-d404y7 img{padding:8px;background:#fff;}.css-1nevh8s{background-color:#bedbda;border-top:1px solid #99c5c2;}.css-c6r19y{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:left;padding-top:16px;padding-bottom:8px;}@media (min-width:600px){.css-c6r19y{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-c6r19y{max-width:1200px;}}.css-v2arnj{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;margin-bottom:16px;font-size:12px;}.css-3qcq41{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;margin-bottom:16px;font-size:12px;margin-left:24px;}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">Sing Mak&#x27;s software engineering journey | AWS CDK Example: Process ordered events with AWS Lambda, SQS FIFO and SNS FIFO</title><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxK.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBBc4.woff2"/><style>@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxK.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxM.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBBc-.woff) format("woff")}</style><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link href="https://fonts.googleapis.com/css?family=Merriweather|Source+Sans+Pro:300,400,400i,700&amp;display=swap" rel="stylesheet"/><link as="script" rel="preload" href="/webpack-runtime-cc6fa0758c63a7d83ea7.js"/><link as="script" rel="preload" href="/framework-d8189f7cda955829bf48.js"/><link as="script" rel="preload" href="/app-37370830dfd1dfcab5fc.js"/><link as="script" rel="preload" href="/3714ed1ea0674b786741a7c3340a00c39e5246c6-e8797e930fcd7ecbf548.js"/><link as="script" rel="preload" href="/component---src-pages-post-mdx-slug-tsx-f041ec6ab74bfbbe894e.js"/><link as="fetch" rel="preload" href="/page-data/post/2021-5-16-sqs-fifo-lambda/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3159585216.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="MuiBox-root css-16w95pb"><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation5 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionSticky css-3v8va9"><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><div class="MuiToolbar-root MuiToolbar-regular css-8p5sgb"><a class="MuiTypography-root MuiTypography-button MuiLink-root MuiLink-underlineNone css-1vo0z3w" href="/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:136px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;30&#x27; width=&#x27;136&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear"></div><picture><source type="image/webp" data-srcset="/static/7a681c1580bd25ffd0f41f646f3afa64/ccc63/singmak_logo.webp 34w,/static/7a681c1580bd25ffd0f41f646f3afa64/98ae6/singmak_logo.webp 68w,/static/7a681c1580bd25ffd0f41f646f3afa64/f51e6/singmak_logo.webp 136w" sizes="(min-width: 136px) 136px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 136px) 136px, 100vw" decoding="async" loading="lazy" data-src="/static/7a681c1580bd25ffd0f41f646f3afa64/f72f6/singmak_logo.png" data-srcset="/static/7a681c1580bd25ffd0f41f646f3afa64/7c010/singmak_logo.png 34w,/static/7a681c1580bd25ffd0f41f646f3afa64/f2fee/singmak_logo.png 68w,/static/7a681c1580bd25ffd0f41f646f3afa64/f72f6/singmak_logo.png 136w" alt="SING MAK"/></picture><noscript><picture><source type="image/webp" srcSet="/static/7a681c1580bd25ffd0f41f646f3afa64/ccc63/singmak_logo.webp 34w,/static/7a681c1580bd25ffd0f41f646f3afa64/98ae6/singmak_logo.webp 68w,/static/7a681c1580bd25ffd0f41f646f3afa64/f51e6/singmak_logo.webp 136w" sizes="(min-width: 136px) 136px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 136px) 136px, 100vw" decoding="async" loading="lazy" src="/static/7a681c1580bd25ffd0f41f646f3afa64/f72f6/singmak_logo.png" srcSet="/static/7a681c1580bd25ffd0f41f646f3afa64/7c010/singmak_logo.png 34w,/static/7a681c1580bd25ffd0f41f646f3afa64/f2fee/singmak_logo.png 68w,/static/7a681c1580bd25ffd0f41f646f3afa64/f72f6/singmak_logo.png 136w" alt="SING MAK"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></a><div class="MuiBox-root css-a9n7s9"><h1 class="MuiTypography-root MuiTypography-body1 css-k6h796">AWS CDK Example: Process ordered events with AWS Lambda, SQS FIFO and SNS FIFO</h1></div><div class="MuiBox-root css-130f8nx"><a class="MuiTypography-root MuiTypography-button MuiLink-root MuiLink-underlineNone css-1n99ejb" href="/">Blog</a><a class="MuiTypography-root MuiTypography-button MuiLink-root MuiLink-underlineNone css-1n99ejb" href="/tags">Tags</a><a class="MuiTypography-root MuiTypography-button MuiLink-root MuiLink-underlineNone css-1n99ejb" href="/about">About</a></div><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-11kqkkz" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuOutlinedIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button></div></div></header><div class="MuiBox-root css-1j414uv"><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-1 MuiGrid-direction-xs-column css-18l9x7f"><div class="MuiGrid-root MuiGrid-item css-1wxaqej"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-r4jyxi" href="https://github.com/singmak"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yxmbwk" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="GitHubIcon"><path d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"></path></svg></button></a></div><div class="MuiGrid-root MuiGrid-item css-1wxaqej"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-r4jyxi" href="https://www.linkedin.com/in/sing-mak-dev"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yxmbwk" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkedInIcon"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"></path></svg></button></a></div></div></div><div class="MuiBox-root css-vooagt"><div class="MuiContainer-root MuiContainer-maxWidthMd css-66wxz3"><h1 class="MuiTypography-root MuiTypography-body1 css-17c40ea">AWS CDK Example: Process ordered events with AWS Lambda, SQS FIFO and SNS FIFO</h1><p class="MuiTypography-root MuiTypography-body1 css-eud0j5">May 16, 2021</p><div class="MuiBox-root css-d404y7"><p>There are many cases in that services need to react based on the events published by another service. And in some cases, the order of the processing of the messages is important. For example, think about bank transactions, the deposit, transfer, withdrawal events need to be processed in order or there may not be enough money in the bank account to withdraw or transfer the money. In this tutorial, I am going to demonstrate how to implement an infrastructure that can handles events produced by one system and consumed by another system in order with AWS CDK, AWS Lambda, Amazon SQS FIFO queues, and Amazon SNS FIFO.</p><h2>Prerequisite</h2><ul><li>AWS CLI environment <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html">setup</a></li><li>Node.js version 12+</li><li>Basic knowledge of typescript</li><li>Basic knowledge of AWS Lambda</li></ul><h2>Setting up the project</h2><h3>Install AWS CDK</h3><p>If you have not installed AWS CDK, you can install it by:</p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-sh" style="white-space:pre"><span>npm </span><span style="color:#954121">install</span><span> aws-cdk
</span><span>cdk </span><span style="color:#408080;font-style:italic">--version</span><span>
</span>
</code></pre></pre><p>If you have installed it already, you should update it to the latest version by</p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-sh" style="white-space:pre"><span style="color:#0086b3">npm</span><span> i -g aws-cdk@latest
</span>
</code></pre></pre><h3>Init the AWS CDK Project</h3><p>Now create a new folder for your project and initialize it as a Typescript AWS CDK project.</p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-sh" style="white-space:pre"><span>mkdir </span><span style="color:#954121">my</span><span>-ordered-message-process-service
</span><span>cd </span><span style="color:#954121">my</span><span>-ordered-message-process-service
</span><span>cdk init app </span><span style="color:#408080;font-style:italic">--language typescript</span><span>
</span>
</code></pre></pre><h3>Install dependencies</h3><p>Install the depencies required for creating the stacks. List of available AWS CDK packages can be found <!-- -->[here]<!-- --> (<a href="https://www.npmjs.com/~aws-cdk-team">https://www.npmjs.com/~aws-cdk-team</a>)</p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-sh" style="white-space:pre"><span>npm i aws-sdk </span><span style="color:#008080">@aws</span><span>-cdk/aws-sns </span><span style="color:#008080">@aws</span><span>-cdk/aws-</span><span style="color:#0086b3">lambda</span><span> </span><span style="color:#008080">@aws</span><span>-cdk/aws-apigateway </span><span style="color:#008080">@aws</span><span>-cdk/aws-sqs \
</span><span></span><span style="color:#008080">@aws</span><span>-cdk/aws-sns-subscriptions </span><span style="color:#008080">@aws</span><span>-cdk/aws-</span><span style="color:#0086b3">lambda</span><span>-event-sources
</span><span>npm i -D </span><span style="color:#008080">@types</span><span>/aws-</span><span style="color:#0086b3">lambda</span><span>
</span>
</code></pre></pre><p>Make sure that all AWS CDK modules are in the same versions or there would be issues in building the project.
If not, you need to update the version in <code>package.json</code> and run <code>npm i</code> again.</p><h3>The stack</h3><p>After the project is initialized by <code>cdk init app</code>, <code>lib/my-ordered-message-process-service-stack.ts</code> should look like this:</p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> cdk </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/core&#x27;</span><span>;
</span>
<span></span><span style="color:#954121">export</span><span> </span><span class="hljs-class" style="color:#954121">class</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#458;font-weight:bold">MyOrderedMessageProcessServiceStack</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#954121">extends</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#458;font-weight:bold">cdk</span><span class="hljs-class">.</span><span class="hljs-class" style="color:#458;font-weight:bold">Stack</span><span class="hljs-class"> </span><span>{
</span><span>  </span><span class="hljs-function" style="color:#458;font-weight:bold">constructor</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#00f">scope: cdk.Construct, id: </span><span class="hljs-function" style="color:#0086b3">string</span><span class="hljs-function" style="color:#00f">, props?: cdk.StackProps</span><span class="hljs-function">)</span><span> {
</span><span>    </span><span style="color:#0086b3">super</span><span>(scope, id, props);
</span><span>    </span><span style="color:#408080;font-style:italic">// The code that defines your stack goes here</span><span>
</span>  }
<!-- -->}
<!-- -->
</code></pre></pre><h3>Update the stack to provision all the resources</h3><p>Now update <code>lib/my-ordered-message-process-service-stack.ts</code> to be like this:</p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> cdk </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/core&#x27;</span><span>;
</span><span></span><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> sns </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/aws-sns&#x27;</span><span>;
</span><span></span><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> lambda </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/aws-lambda&#x27;</span><span>;
</span><span></span><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> apigateway </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/aws-apigateway&#x27;</span><span>;
</span><span></span><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> sqs </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/aws-sqs&#x27;</span><span>;
</span><span></span><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> snsSubscriptions </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/aws-sns-subscriptions&#x27;</span><span>;
</span><span></span><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> lambdaEventSources </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/aws-lambda-event-sources&#x27;</span><span>;
</span><span></span><span style="color:#954121">import</span><span> { Duration } </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;@aws-cdk/core&#x27;</span><span>;
</span><span></span><span style="color:#954121">export</span><span> </span><span class="hljs-class" style="color:#954121">class</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#458;font-weight:bold">MyOrderedMessageProcessServiceStack</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#954121">extends</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#458;font-weight:bold">cdk</span><span class="hljs-class">.</span><span class="hljs-class" style="color:#458;font-weight:bold">Stack</span><span class="hljs-class"> </span><span>{
</span><span>  </span><span class="hljs-function" style="color:#458;font-weight:bold">constructor</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#00f">scope: cdk.Construct, id: </span><span class="hljs-function" style="color:#0086b3">string</span><span class="hljs-function" style="color:#00f">, props?: cdk.StackProps</span><span class="hljs-function">)</span><span> {
</span><span>    </span><span style="color:#0086b3">super</span><span>(scope, id, props);
</span>
<span>    </span><span style="color:#954121">const</span><span> eventMessageTopic = </span><span style="color:#954121">new</span><span> sns.Topic(</span><span style="color:#0086b3">this</span><span>, </span><span style="color:#219161">&#x27;EventMessageTopic&#x27;</span><span>, {
</span><span>      </span><span class="hljs-attr">topicName</span><span>: </span><span style="color:#219161">&#x27;eventMessages&#x27;</span><span>,
</span><span>      </span><span class="hljs-attr">fifo</span><span>: </span><span style="color:#954121">true</span><span>,
</span><span>      </span><span class="hljs-attr">contentBasedDeduplication</span><span>: </span><span style="color:#954121">true</span><span>,
</span>    });
<!-- -->
<span>    </span><span style="color:#408080;font-style:italic">// This is optional, you can also publish messages to the SNS topic in any other ways.</span><span>
</span><span>    </span><span style="color:#408080;font-style:italic">// The Lambda code is set to load from `./lambda/handler.js` (will be generated by `npm run build`)</span><span>
</span><span>    </span><span style="color:#408080;font-style:italic">// `EVENT_MESSAGE_TOPIC_ARN` is passed into environment variable so that the function can access it</span><span>
</span><span>    </span><span style="color:#954121">const</span><span> publishEventLambda = </span><span style="color:#954121">new</span><span> lambda.Function(</span><span style="color:#0086b3">this</span><span>, </span><span style="color:#219161">&#x27;PublishEventMessage&#x27;</span><span>, {
</span><span>      </span><span class="hljs-attr">runtime</span><span>: lambda.Runtime.NODEJS_14_X,
</span><span>      </span><span class="hljs-attr">code</span><span>: lambda.Code.fromAsset(</span><span style="color:#219161">&quot;./lambda&quot;</span><span>),
</span><span>      </span><span class="hljs-attr">handler</span><span>: </span><span style="color:#219161">&quot;handler.publishMessage&quot;</span><span>,
</span><span>      </span><span class="hljs-attr">environment</span><span>: {
</span><span>        </span><span class="hljs-attr">EVENT_MESSAGE_TOPIC_ARN</span><span>: eventMessageTopic.topicArn,
</span>      }
<!-- -->    });
<!-- -->
<span>    </span><span style="color:#408080;font-style:italic">// grant the lambda permission to publish message to the SNS topic</span><span>
</span>    eventMessageTopic.grantPublish(publishEventLambda);
<!-- -->
<span>    </span><span style="color:#408080;font-style:italic">// Create the Rest API</span><span>
</span><span>    </span><span style="color:#954121">const</span><span> api = </span><span style="color:#954121">new</span><span> apigateway.RestApi(</span><span style="color:#0086b3">this</span><span>, </span><span style="color:#219161">&quot;MessageApi&quot;</span><span>, {
</span><span>      </span><span class="hljs-attr">restApiName</span><span>: </span><span style="color:#219161">&quot;messageApi&quot;</span><span>,
</span><span>      </span><span class="hljs-attr">description</span><span>: </span><span style="color:#219161">&quot;API for publishing messages.&quot;</span><span>
</span>    });
<span>    </span><span style="color:#408080;font-style:italic">// Add the path /users in the API</span><span>
</span><span>    </span><span style="color:#954121">const</span><span> apiResource = api.root.addResource(</span><span style="color:#219161">&quot;messages&quot;</span><span>);
</span><span>    </span><span style="color:#954121">const</span><span> getIntegration = </span><span style="color:#954121">new</span><span> apigateway.LambdaIntegration(publishEventLambda);
</span><span>    apiResource.addMethod(</span><span style="color:#219161">&quot;POST&quot;</span><span>, getIntegration);
</span>
<span>    </span><span style="color:#408080;font-style:italic">// create SQS FIFO queue</span><span>
</span><span>    </span><span style="color:#954121">const</span><span> processMessageQueue = </span><span style="color:#954121">new</span><span> sqs.Queue(</span><span style="color:#0086b3">this</span><span>, </span><span style="color:#219161">&#x27;ProcessMessage&#x27;</span><span>, {
</span><span>      </span><span class="hljs-attr">queueName</span><span>: </span><span style="color:#219161">&#x27;processMessage.fifo&#x27;</span><span>,
</span><span>      </span><span class="hljs-attr">fifo</span><span>: </span><span style="color:#954121">true</span><span>,
</span>    });
<!-- -->
<span>    </span><span style="color:#408080;font-style:italic">// subscribe to the SNS queue</span><span>
</span><span>    eventMessageTopic.addSubscription(</span><span style="color:#954121">new</span><span> snsSubscriptions.SqsSubscription(processMessageQueue));
</span>
<span>    </span><span style="color:#408080;font-style:italic">// create the Lambda function and subscribe</span><span>
</span><span>    </span><span style="color:#954121">const</span><span> processEventLambda = </span><span style="color:#954121">new</span><span> lambda.Function(</span><span style="color:#0086b3">this</span><span>, </span><span style="color:#219161">&#x27;ProcessEvent&#x27;</span><span>, {
</span><span>      </span><span class="hljs-attr">runtime</span><span>: lambda.Runtime.NODEJS_14_X,
</span><span>      </span><span class="hljs-attr">code</span><span>: lambda.Code.fromAsset(</span><span style="color:#219161">&quot;./lambda&quot;</span><span>),
</span><span>      </span><span class="hljs-attr">handler</span><span>: </span><span style="color:#219161">&quot;handler.processMessage&quot;</span><span>,
</span><span>      </span><span class="hljs-attr">timeout</span><span>: Duration.seconds(</span><span style="color:#40a070">10</span><span>), </span><span style="color:#408080;font-style:italic">// need to be smaller than the visibilityTimeout of the SQS queue</span><span>
</span>    });
<span>    processEventLambda.addEventSource(</span><span style="color:#954121">new</span><span> lambdaEventSources.SqsEventSource(processMessageQueue, {
</span><span>      </span><span class="hljs-attr">batchSize</span><span>: </span><span style="color:#40a070">2</span><span>
</span>    }));
<!-- -->  }
<!-- -->}
<!-- -->
</code></pre></pre><h3>Create the handlers for the Lambda functions</h3><p>Create a new folder <code>lambda</code> in the project folder and create a new file <code>handler.ts</code>
Put the codes below in <code>./lambda/handler.ts</code></p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-typescript" style="white-space:pre"><span style="color:#954121">import</span><span> * </span><span style="color:#954121">as</span><span> AWS </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;aws-sdk&#x27;</span><span>;
</span><span></span><span style="color:#954121">import</span><span> { APIGatewayEvent, APIGatewayProxyResult, SQSEvent } </span><span style="color:#954121">from</span><span> </span><span style="color:#219161">&#x27;aws-lambda&#x27;</span><span>;
</span>
<span></span><span style="color:#408080;font-style:italic">// this is passed from the CDK stack</span><span>
</span><span></span><span style="color:#954121">const</span><span> { EVENT_MESSAGE_TOPIC_ARN } = process.env;
</span>
<span></span><span style="color:#954121">const</span><span> sns = </span><span style="color:#954121">new</span><span> AWS.SNS();
</span>
<span></span><span style="color:#954121">export</span><span> </span><span style="color:#954121">const</span><span> publishMessage = </span><span style="color:#954121">async</span><span> (event: APIGatewayEvent): </span><span style="color:#0086b3">Promise</span><span>&lt;APIGatewayProxyResult&gt; =&gt; {
</span><span>  </span><span style="color:#954121">try</span><span> {
</span><span>    </span><span style="color:#954121">const</span><span> { body } = event;
</span><span>    </span><span style="color:#954121">if</span><span> (!body) </span><span style="color:#954121">throw</span><span> </span><span style="color:#954121">new</span><span> </span><span style="color:#0086b3">Error</span><span>(</span><span style="color:#219161">&#x27;no body&#x27;</span><span>);
</span><span>    </span><span style="color:#954121">const</span><span> eventMessages = </span><span style="color:#0086b3">JSON</span><span>.parse(body);
</span><span>    </span><span style="color:#0086b3">console</span><span>.log(event);
</span><span>    </span><span style="color:#954121">for</span><span> (</span><span style="color:#954121">const</span><span> eventMessage </span><span style="color:#954121">of</span><span> eventMessages) {
</span><span>        </span><span style="color:#954121">const</span><span> { groupId, message } = eventMessage;
</span><span>        </span><span style="color:#954121">const</span><span> response = </span><span style="color:#954121">await</span><span> sns.publish({
</span><span>            </span><span class="hljs-attr">TopicArn</span><span>: EVENT_MESSAGE_TOPIC_ARN,
</span><span>            </span><span class="hljs-attr">Message</span><span>: message,
</span><span>            </span><span class="hljs-attr">MessageGroupId</span><span>: groupId,
</span>        }).promise();
<span>        </span><span style="color:#0086b3">console</span><span>.log(response);
</span>    }
<span>    </span><span style="color:#954121">return</span><span> {
</span><span>      </span><span class="hljs-attr">statusCode</span><span>: </span><span style="color:#40a070">200</span><span>,
</span><span>      </span><span class="hljs-attr">body</span><span>: eventMessages.length,
</span>    };
<span>  } </span><span style="color:#954121">catch</span><span> (e) {
</span><span>    </span><span style="color:#954121">return</span><span> {
</span><span>      </span><span class="hljs-attr">statusCode</span><span>: </span><span style="color:#40a070">500</span><span>,
</span><span>      </span><span class="hljs-attr">body</span><span>: </span><span style="color:#0086b3">JSON</span><span>.stringify(e),
</span>    }
<!-- -->  }
<!-- -->}
<!-- -->
<span></span><span style="color:#954121">export</span><span> </span><span style="color:#954121">const</span><span> processMessage = </span><span style="color:#954121">async</span><span> (event: SQSEvent) =&gt; {
</span><span>  </span><span style="color:#0086b3">console</span><span>.log(</span><span style="color:#219161">&#x27;process message start&#x27;</span><span>, </span><span style="color:#954121">new</span><span> </span><span style="color:#0086b3">Date</span><span>().toISOString());
</span><span>  </span><span style="color:#954121">for</span><span> (</span><span style="color:#954121">const</span><span> record </span><span style="color:#954121">of</span><span> event.Records) {
</span><span>    </span><span style="color:#0086b3">console</span><span>.log(</span><span style="color:#219161">`process message... </span><span style="color:#954121">${record.body}</span><span style="color:#219161">`</span><span>);
</span><span>    </span><span style="color:#954121">await</span><span> </span><span style="color:#954121">new</span><span> </span><span style="color:#0086b3">Promise</span><span>(</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#00f">resolve</span><span class="hljs-function">) =&gt;</span><span> </span><span style="color:#0086b3">setTimeout</span><span>(resolve, </span><span style="color:#40a070">3000</span><span>)); </span><span style="color:#408080;font-style:italic">// similate that it takes 3 secs to process the message</span><span>
</span>  }
<span>  </span><span style="color:#0086b3">console</span><span>.log(</span><span style="color:#219161">&#x27;process message end&#x27;</span><span>, </span><span style="color:#954121">new</span><span> </span><span style="color:#0086b3">Date</span><span>().toISOString());
</span>};
<!-- -->
</code></pre></pre><h2>Build and deploy the stack!!!</h2><p>First you need to build the lambda handler functions</p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-sh" style="white-space:pre"><span>npm </span><span style="color:#0086b3">run</span><span> build
</span>
</code></pre></pre><p>Bootstrap the AWS CDK app to provision resources the AWS CDK needs to perform the deployment. For example, AWS CDK may need to have an S3 bucket to store assets that will be used during the deployment of the stack. <a href="https://docs.aws.amazon.com/cdk/latest/guide/bootstrapping.html">Learn more</a></p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-sh" style="white-space:pre"><span style="color:#000080;font-weight:normal">cdk bootstrap</span><span>
</span>
</code></pre></pre><p>Deploy the AWS CDK app</p><pre><pre style="display:block;overflow-x:auto;padding:0.5em;color:#000;background:#f8f8ff;border-left:5px solid #a5d6a7;padding-top:5px;padding-left:16px;padding-right:16px"><code class="language-sh" style="white-space:pre"><span style="color:#000080;font-weight:normal">cdk deploy</span><span>
</span>
</code></pre></pre><p>The url of the rest API will be displayed in the console output if it&#x27;s deployed successfully</p><h2>Test the deployed stack</h2><p>Since we provisioned a POST API <code>/messages</code> to publishing the messages to the queue, you can use any tools to call the API to test publishing messages
For example, I use <a href="https://marketplace.visualstudio.com/items?itemName=rangav.vscode-thunder-client">Thunder client</a> to make an HTTP request with a JSON body like this
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:758px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:66.66666666666666%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABXElEQVQ4y6WSTU7DMBCFcwlUNY2dxPbE/01SkCoqVe2CDVfgApyDkz9kh1RUpQLaxdN4PNY3b2wX3nsYYxBjxDAMWX3fI3iP9Xqd87mW8lQbxzHv8bpGwyuUXcTi7QMPr+8orLUQQoCIcnTOoVWEuHmCVATqNOqmAeccdQI0zUkprzkHaxWW4wFl2KKYQQkspYTWGooI2gVoY6YGbZv3U2SMZfiZGENdLlCvliiUUnDeI/YD2tSVczRNm2NqoKTMblLjFH8EJpe8BuMcxezOWJtHFVJAimmc+fC8ziNe0XwFRVqkUZSxWO9f4GPAY6RcnN18j9c0NywyTEp01iE8H2C9w+DVGfA3XQClEBNwNwFHnxzy24GkFMg4xN0xP9AY6HaH6VG6jkDGIuyOk8O7gUQg++UweGzuAbZCQHcdlDbw233+Pr1TZwf/BTz9Ic5RrUpUVYWqYhdf5q/AT3epa4zoGIXjAAAAAElFTkSuQmCC&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="test example" title="test example" src="/static/829417419a95540feb683298dee927e0/c8e86/cdk-test-publish-messages.png" srcSet="/static/829417419a95540feb683298dee927e0/5a46d/cdk-test-publish-messages.png 300w,/static/829417419a95540feb683298dee927e0/0a47e/cdk-test-publish-messages.png 600w,/static/829417419a95540feb683298dee927e0/c8e86/cdk-test-publish-messages.png 758w" sizes="(max-width: 758px) 100vw, 758px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
    </span></p><p>You can check the logs and metrics for SNS and SQS on CloudWatch in the AWS console to check the results of the publishing and processing of the messages. If all works correctly, you should be able to see that the messages are processed one by one in sequences in the correct order from the Cloudwatch logs of the Lambda function that process the messages.
<span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:842px">
      <a class="gatsby-resp-image-link" href="/static/c9f3c6f0ec5af2d74a22595c4d14001b/99072/messages-logs.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:60%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAABl0lEQVQoz12TWZLDMAhEdf9DJl5lW5b3LYlTxdRDViYzHxQgLNR0Y9MPg7Stl3lZ5DgO2ff98of6aOd5yuv1UiM+z+jPPzWTZbkkSSrWVlJaK23bSl03Ute1lKVVIx+GQZZ1lXEcpes6GYZRz/oe62WaZlnXTQxFEHrfSdO4T+yvc85Av66rIt22TeNvW5ZFJ6NmWu/FOSfOtdJ1/eU78d4rWppP06QoyEE0jpP0FzpQkuMfj4cYmjEuI/ACr83zrE0wYs6ez6ei4BJx9NHIPxzmeSFFUSqXTRP4Y9SyLLVGXlW1PgDiWK84h2trdQL4Nfck0UZ5HsThorVWUWd5Lmma6ahcDA29VFUljXPqo5jQpQ1Zj0jotu06XiD6l3TEYKT/I7Mu7/dbLa6OAcXtdtdXIBYEURCnonjlFwFCHEQADY3j/mHkBo7YNS4jEFyEpt1HffLvtYlTsHuIxgPkTGjgDUFAmGaBL5qwg/BDjYZJmipPiFGU4XtqRVFcPHtdN4MIIOGARiAljo1RHTG+f0O4jNxHi7UfutCOg5d9OBkAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="messages logs" title="messages logs" src="/static/c9f3c6f0ec5af2d74a22595c4d14001b/99072/messages-logs.png" srcSet="/static/c9f3c6f0ec5af2d74a22595c4d14001b/5a46d/messages-logs.png 300w,/static/c9f3c6f0ec5af2d74a22595c4d14001b/0a47e/messages-logs.png 600w,/static/c9f3c6f0ec5af2d74a22595c4d14001b/99072/messages-logs.png 842w" sizes="(max-width: 842px) 100vw, 842px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy" decoding="async"/>
  </a>
    </span></p><h2>Source code of this example</h2><p><a href="https://github.com/singmak/my-ordered-message-process-service">https://github.com/singmak/my-ordered-message-process-service</a></p></div></div></div><div class="MuiBox-root css-1nevh8s"><div class="MuiContainer-root MuiContainer-maxWidthLg css-c6r19y"><p class="MuiTypography-root MuiTypography-body1 MuiTypography-paragraph css-v2arnj">© 2022 Sing Mak</p><p class="MuiTypography-root MuiTypography-body1 MuiTypography-paragraph css-3qcq41">Built with <a href="https://www.gatsbyjs.com" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-r4jyxi">Gatsby</a> and <a href="https://mui.com" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-r4jyxi">MUI</a></p></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/post/2021-5-16-sqs-fifo-lambda/";window.___webpackCompilationHash="1a8fa5f1306e893f21db";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-9a282e6bbe6b2b98339c.js"],"app":["/app-37370830dfd1dfcab5fc.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-a95993188f5a7562bae7.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-51c47face5798823f7d2.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-fcf3d156f5ba50414d1c.js"],"component---src-pages-post-mdx-slug-tsx":["/component---src-pages-post-mdx-slug-tsx-f041ec6ab74bfbbe894e.js"],"component---src-pages-tags-tsx":["/component---src-pages-tags-tsx-ae41b29e7d66d219bb38.js"],"component---src-templates-tag-tsx":["/component---src-templates-tag-tsx-c3787920d51c05f2c57e.js"]};/*]]>*/</script><script src="/polyfill-9a282e6bbe6b2b98339c.js" nomodule=""></script><script src="/component---src-pages-post-mdx-slug-tsx-f041ec6ab74bfbbe894e.js" async=""></script><script src="/3714ed1ea0674b786741a7c3340a00c39e5246c6-e8797e930fcd7ecbf548.js" async=""></script><script src="/app-37370830dfd1dfcab5fc.js" async=""></script><script src="/framework-d8189f7cda955829bf48.js" async=""></script><script src="/webpack-runtime-cc6fa0758c63a7d83ea7.js" async=""></script></body></html>