<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.11.0"/><meta data-react-helmet="true" charSet="utf-8"/><meta data-react-helmet="true" name="google-site-verification" content="0BOaKw-N8goBTlYnHzJWtb6Yn_4GeZjZHaVxq_RmV3E"/><style data-href="/styles.6ed856706c4e7f2d4814.css" data-identity="gatsby-global-css">a{color:#1976d2}a:hover{color:#004ba0}</style><style data-emotion="css-global 1mskswx">html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;box-sizing:border-box;-webkit-text-size-adjust:100%;}*,*::before,*::after{box-sizing:inherit;}strong,b{font-weight:700;}body{margin:0;color:rgba(0, 0, 0, 0.87);font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;background-color:#fff;}@media print{body{background-color:#fff;}}body::backdrop{background-color:#fff;}</style><style data-emotion="css 16w95pb 3v8va9 1qsxih2 12o98wt 81nvfi a9n7s9 k6h796 130f8nx hv5q7o 11kqkkz vubbuv 1j414uv 18l9x7f 1wxaqej m136qf 1yxmbwk vooagt 66wxz3 17c40ea eud0j5 d404y7 1nevh8s c6r19y v2arnj 3qcq41">.css-16w95pb{background-color:#e6f1f3;min-height:100vh;}.css-3v8va9{background-color:#fff;color:rgba(0, 0, 0, 0.87);-webkit-transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;box-shadow:0px 3px 5px -1px rgba(0,0,0,0.2),0px 5px 8px 0px rgba(0,0,0,0.14),0px 1px 14px 0px rgba(0,0,0,0.12);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:100%;box-sizing:border-box;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;position:-webkit-sticky;position:sticky;z-index:1100;top:0;left:auto;right:0;background-color:#456679;color:#fff;}.css-1qsxih2{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;}@media (min-width:600px){.css-1qsxih2{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-1qsxih2{max-width:1200px;}}.css-12o98wt{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:56px;}@media (min-width:0px){@media (orientation: landscape){.css-12o98wt{min-height:48px;}}}@media (min-width:600px){.css-12o98wt{min-height:64px;}}.css-81nvfi{margin:0;font-family:Merriweather,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;text-transform:uppercase;color:rgba(0, 0, 0, 0.87);-webkit-text-decoration:none;text-decoration:none;margin-right:8px;}.css-a9n7s9{margin-left:auto;margin-right:auto;}.css-k6h796{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;color:#fff;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}@media (min-width:0px){.css-k6h796{display:none;}}@media (min-width:900px){.css-k6h796{display:block;}}@media (min-width:0px){.css-130f8nx{display:none;}}@media (min-width:600px){.css-130f8nx{display:block;}}.css-hv5q7o{margin:0;font-family:Merriweather,sans-serif;font-weight:500;font-size:0.875rem;line-height:1.75;text-transform:uppercase;color:rgba(0, 0, 0, 0.87);-webkit-text-decoration:none;text-decoration:none;margin-left:20px;color:#fff;font-family:roboto;padding:5px 7px;background-color:#51748a;text-align:center;}.css-hv5q7o:hover{color:#fff;background-color:#6a889c;}.css-11kqkkz{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;sx:block;color:#fff;}.css-11kqkkz::-moz-focus-inner{border-style:none;}.css-11kqkkz.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-11kqkkz{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-11kqkkz:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-11kqkkz:hover{background-color:transparent;}}.css-11kqkkz.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}@media (min-width:600px){.css-11kqkkz{display:none;}}.css-vubbuv{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1em;height:1em;display:inline-block;fill:currentColor;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;-webkit-transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:fill 200ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;font-size:1.5rem;}.css-1j414uv{position:fixed;right:5px;top:200px;}@media (min-width:0px){.css-1j414uv{display:none;}}@media (min-width:900px){.css-1j414uv{display:block;}}.css-18l9x7f{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;margin-top:-8px;width:calc(100% + 8px);margin-left:-8px;}.css-18l9x7f>.MuiGrid-item{max-width:none;}.css-18l9x7f>.MuiGrid-item{padding-top:8px;}.css-18l9x7f>.MuiGrid-item{padding-left:8px;}.css-1wxaqej{box-sizing:border-box;margin:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}.css-m136qf{margin:0;font-family:inherit;font-weight:inherit;font-size:inherit;line-height:inherit;letter-spacing:inherit;color:#456679;-webkit-text-decoration:underline;text-decoration:underline;text-decoration-color:rgba(69, 102, 121, 0.4);}.css-m136qf:hover{text-decoration-color:inherit;}.css-1yxmbwk{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;position:relative;box-sizing:border-box;-webkit-tap-highlight-color:transparent;background-color:transparent;outline:0;border:0;margin:0;border-radius:0;padding:0;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle;-moz-appearance:none;-webkit-appearance:none;-webkit-text-decoration:none;text-decoration:none;color:inherit;text-align:center;-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;font-size:1.5rem;padding:8px;border-radius:50%;overflow:visible;color:rgba(0, 0, 0, 0.54);-webkit-transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;transition:background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;}.css-1yxmbwk::-moz-focus-inner{border-style:none;}.css-1yxmbwk.Mui-disabled{pointer-events:none;cursor:default;}@media print{.css-1yxmbwk{-webkit-print-color-adjust:exact;color-adjust:exact;}}.css-1yxmbwk:hover{background-color:rgba(0, 0, 0, 0.04);}@media (hover: none){.css-1yxmbwk:hover{background-color:transparent;}}.css-1yxmbwk.Mui-disabled{background-color:transparent;color:rgba(0, 0, 0, 0.26);}.css-vooagt{min-height:100vh;}.css-66wxz3{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;padding:40px;}@media (min-width:600px){.css-66wxz3{padding-left:24px;padding-right:24px;}}@media (min-width:900px){.css-66wxz3{max-width:900px;}}.css-17c40ea{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;}@media (min-width:0px){.css-17c40ea{font-size:2rem;}}@media (min-width:900px){.css-17c40ea{font-size:2.5rem;}}.css-eud0j5{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;}.css-d404y7 img{padding:8px;background:#fff;}.css-1nevh8s{background-color:#bedbda;border-top:1px solid #99c5c2;}.css-c6r19y{width:100%;margin-left:auto;box-sizing:border-box;margin-right:auto;display:block;padding-left:16px;padding-right:16px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:left;padding-top:16px;padding-bottom:8px;}@media (min-width:600px){.css-c6r19y{padding-left:24px;padding-right:24px;}}@media (min-width:1200px){.css-c6r19y{max-width:1200px;}}.css-v2arnj{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;margin-bottom:16px;font-size:12px;}.css-3qcq41{margin:0;font-family:Merriweather,sans-serif;font-weight:400;font-size:1rem;line-height:1.5;margin-bottom:16px;font-size:12px;margin-left:24px;}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2"/><link rel="preload" as="font" type="font/woff2" crossorigin="anonymous" href="/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.woff2"/><style>@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxK.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc4.woff2) format("woff2")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:300;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmSU5fBBc-.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:400;src:url(/static/webfonts/s/roboto/v30/KFOmCnqEu92Fr1Mu4mxM.woff) format("woff")}@font-face{font-display:swap;font-family:Roboto;font-style:normal;font-weight:500;src:url(/static/webfonts/s/roboto/v30/KFOlCnqEu92Fr1MmEU9fBBc-.woff) format("woff")}</style><title data-react-helmet="true">Sing Mak&#x27;s software engineering journey | Finding out the cold start time of a AWS Lambda function</title><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link href="https://fonts.googleapis.com/css?family=Merriweather|Source+Sans+Pro:300,400,400i,700&amp;display=swap" rel="stylesheet"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="MuiBox-root css-16w95pb"><header class="MuiPaper-root MuiPaper-elevation MuiPaper-elevation5 MuiAppBar-root MuiAppBar-colorPrimary MuiAppBar-positionSticky css-3v8va9"><div class="MuiContainer-root MuiContainer-maxWidthLg css-1qsxih2"><div class="MuiToolbar-root MuiToolbar-regular css-12o98wt"><a class="MuiTypography-root MuiTypography-button MuiLink-root MuiLink-underlineNone css-81nvfi" href="/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:136px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;30&#x27;%20width=&#x27;136&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear"></div><picture><source type="image/webp" data-srcset="/static/7a681c1580bd25ffd0f41f646f3afa64/ccc63/singmak_logo.webp 34w,/static/7a681c1580bd25ffd0f41f646f3afa64/98ae6/singmak_logo.webp 68w,/static/7a681c1580bd25ffd0f41f646f3afa64/f51e6/singmak_logo.webp 136w" sizes="(min-width: 136px) 136px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 136px) 136px, 100vw" decoding="async" loading="lazy" data-src="/static/7a681c1580bd25ffd0f41f646f3afa64/f72f6/singmak_logo.png" data-srcset="/static/7a681c1580bd25ffd0f41f646f3afa64/7c010/singmak_logo.png 34w,/static/7a681c1580bd25ffd0f41f646f3afa64/f2fee/singmak_logo.png 68w,/static/7a681c1580bd25ffd0f41f646f3afa64/f72f6/singmak_logo.png 136w" alt="SING MAK"/></picture><noscript><picture><source type="image/webp" srcSet="/static/7a681c1580bd25ffd0f41f646f3afa64/ccc63/singmak_logo.webp 34w,/static/7a681c1580bd25ffd0f41f646f3afa64/98ae6/singmak_logo.webp 68w,/static/7a681c1580bd25ffd0f41f646f3afa64/f51e6/singmak_logo.webp 136w" sizes="(min-width: 136px) 136px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 136px) 136px, 100vw" decoding="async" loading="lazy" src="/static/7a681c1580bd25ffd0f41f646f3afa64/f72f6/singmak_logo.png" srcSet="/static/7a681c1580bd25ffd0f41f646f3afa64/7c010/singmak_logo.png 34w,/static/7a681c1580bd25ffd0f41f646f3afa64/f2fee/singmak_logo.png 68w,/static/7a681c1580bd25ffd0f41f646f3afa64/f72f6/singmak_logo.png 136w" alt="SING MAK"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></a><div class="MuiBox-root css-a9n7s9"><h1 class="MuiTypography-root MuiTypography-body1 css-k6h796">The road to Zero Downtime: Blue-Green Deployment and Microservices</h1></div><div class="MuiBox-root css-130f8nx"><a class="MuiTypography-root MuiTypography-button MuiLink-root MuiLink-underlineNone css-hv5q7o" href="/">Blog</a><a class="MuiTypography-root MuiTypography-button MuiLink-root MuiLink-underlineNone css-hv5q7o" href="/tags">Tags</a><a class="MuiTypography-root MuiTypography-button MuiLink-root MuiLink-underlineNone css-hv5q7o" href="/about">About</a></div><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-11kqkkz" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="MenuOutlinedIcon"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></button></div></div></header><div class="MuiBox-root css-1j414uv"><div class="MuiGrid-root MuiGrid-container MuiGrid-spacing-xs-1 MuiGrid-direction-xs-column css-18l9x7f"><div class="MuiGrid-root MuiGrid-item css-1wxaqej"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-m136qf" href="https://github.com/singmak"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yxmbwk" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="GitHubIcon"><path d="M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"></path></svg></button></a></div><div class="MuiGrid-root MuiGrid-item css-1wxaqej"><a class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-m136qf" href="https://www.linkedin.com/in/sing-mak-dev"><button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-1yxmbwk" tabindex="0" type="button"><svg class="MuiSvgIcon-root MuiSvgIcon-fontSizeMedium css-vubbuv" focusable="false" aria-hidden="true" viewBox="0 0 24 24" data-testid="LinkedInIcon"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-.5 15.5v-5.3a3.26 3.26 0 0 0-3.26-3.26c-.85 0-1.84.52-2.32 1.3v-1.11h-2.79v8.37h2.79v-4.93c0-.77.62-1.4 1.39-1.4a1.4 1.4 0 0 1 1.4 1.4v4.93h2.79M6.88 8.56a1.68 1.68 0 0 0 1.68-1.68c0-.93-.75-1.69-1.68-1.69a1.69 1.69 0 0 0-1.69 1.69c0 .93.76 1.68 1.69 1.68m1.39 9.94v-8.37H5.5v8.37h2.77z"></path></svg></button></a></div></div></div><div class="MuiBox-root css-vooagt"><div class="MuiContainer-root MuiContainer-maxWidthMd css-66wxz3"><h1 class="MuiTypography-root MuiTypography-body1 css-17c40ea">The road to Zero Downtime: Blue-Green Deployment and Microservices</h1><p class="MuiTypography-root MuiTypography-body1 css-eud0j5">March 12, 2022</p><div class="MuiBox-root css-d404y7"><p>In this post, I am going to share what I have learned so far about Blue-Green deployment and discuss the different approaches and possible challenges of doing Blue-Green Deployment. There could be things that I am not aware of since I haven&#x27;t put them into practice yet. So I may write another post to share my experience when I have the opportunity to apply this interesting technique at work :).</p>
<h1>What is Blue-Green Deployment?</h1>
<p>Blue-Green Deployment is one of the techniques to help us to deploy changes of applications to production without causing downtime in the services. The idea is that during the deployment of the new version of the service, we won&#x27;t shut down the base service, and so there are periods that there are 2 versions of the services are running concurrently. The base version of the service will continue to receive the traffic during the deploying of the new version of the service, and once the deployment is done and tested ok, we can route all the traffic to the new version of the service and cut off the traffic from the original version of the service.</p>
<p>There can be different approaches in Blue-Green Deployment in a system with microservices architecture.</p>
<h1>Different approaches</h1>
<h2>Approach 1: Maintain 2 Production environments and always release new versions of all the services at the same time</h2>
<p>In this approach, we need to set up and maintain 2 production environments. One of them is active (Blue) and receives all of the traffic while the other one (Green) is used for deployment of the new versions of the services. We can take time to do the deployment and run testing on the inactive environment. Once we decide that the Green environment is ready, we change the route so that all the traffic goes to the Green environment instead. We can monitor the changes for several days and observe if the changes are causing any problems during real usage by the users. If there are critical issues in the new changes, we can easily switch back to the previous version by changing the route back to the Blue environment. This gives us buffer time to fix the problems without causing more downtime.</p>
<h3>Advantages</h3>
<ul>
<li>Less effort on maintaining compatibilities between the services since the old version of the services and the new version of the services don&#x27;t interact with each other.</li>
<li>No new technology is introduced to the stack, we can just set up and deploy the 2 production environments in the same way.</li>
<li>Since we do the release of all the services together, the overhead of doing releases such as documentation, testing, monitoring, etc can be reduced.</li>
</ul>
<h3>Disadvantages</h3>
<ul>
<li>Extra cost of keeping 2 live productions environments. We can decide to stop the instances in the inactive production environment when we are not doing any deployments.</li>
<li>Extra work to set up and maintain 2 production environments.</li>
<li>The services must be released at the same time and rolled back at the same time.</li>
</ul>
<h2>Approach 2: Maintain only one production system and release each service independently</h2>
<p>With this approach, the unit of the deployment is one service (or a stack of multiple services) instead of the whole system. The route switchover would need to be done at the service level instead of the whole system level. During deployment of the service, new instances are provisioned for the new version of the service. When the new version services are fully ready, we can do the switchover of the production traffic to the new instances. We can decide to keep the original instances (old version) of the services for some time for the ease of rolling back the changes. When we are sure that the new version of the service is working probably, the old instances can be safely terminated.</p>
<h3>Advantages</h3>
<ul>
<li>Services can be released/rolled back independently and concurrently by different teams</li>
<li>Less cost on hosting the services.<!-- -->
<ul>
<li>Only need to provision new instances for the services that are being released</li>
<li>Old instances can be discarded when the deployment is done.</li>
</ul>
</li>
</ul>
<h3>Disadvantages</h3>
<ul>
<li>More time and effort on doing releases, testing, and rolling back changes. Instead of doing these tasks altogether in a single release, we need to do those tasks for each service since each service has its own release lifecycle.</li>
<li>More effort on maintaining backward compatibility, we need to make sure that the new changes in the service won&#x27;t break the other services.</li>
<li>Rolling back changes is more difficult. If we roll back the changes of one service, we may also break some other services that depend on the new APIs.</li>
<li>More effort on setting up Blue-Green Deployment on every service</li>
</ul>
<h2>Which approach should we use?</h2>
<p>Approach 1 is the easier approach, requires less effort on doing the release, and allows us to roll back changes instantaneously. The main disadvantages are the extra effort and cost to maintain 2 production environments. This can be a good approach for systems that are always released by one team only at any given time.</p>
<p>Approach 2 can be a good approach for a large system where there is a need to handle the releases of the services independently and concurrently by multiple teams so it&#x27;s not possible to do the switchover from one production environment to a completely different production environment for the whole system. The disadvantages are more effort on maintaining the backward compatibilities of the services and the overhead of doing releases of individual services.</p>
<h1>Challenges</h1>
<h3>Synchronization of data between the 2 production environments</h3>
<p>If each production environment has its database, we need to have a mechanism to synchronize the data in the 2 databases, which can be very complex to implement. Sharing the database between the Blue and Green environments could be the easier approach but we need to make sure that the database schema is compatible with both Blue and Green environments.</p>
<h3>Handling the transactions that happen during the switchover</h3>
<p>When we change the route from a Green environment to a Blue environment, the users may be in the middle of doing something. Users may lose their sessions in the previous services instances, the system may not be able to handle the requests probably. Backend services should return errors probably in these situations and the frontend applications should handle the errors gracefully such as showing a message to the user and force reload of the application. If the user is in the middle of working on something, the user may lose his/her work because of the systems changes, we can resolve this by saving the users&#x27; changes on the client or database from time to time automatically. Also, we can implement backward compatibility in the API so that even if the users are doing work on the old version of the applications, they can still complete their work without problems.</p>
<h3>Web application</h3>
<p>The browser may cache the old version of the web application for too long. We can implement a mechanism so that the user&#x27;s browser always loads the latest version of the web application.</p>
<h3>Mobile application</h3>
<p>A new version of a mobile application can take days to roll out to the users. Therefore, whenever we deploy a new version of a backend service, we need to make sure that APIs are still compatible with different versions of the mobile applications. On the other hand, we should also be careful about rolling back backend changes since it can break the newer version of the mobile app. In the worst-case scenario where we have to introduce changes of the backend that are not compatible with some versions of the mobile applications, we can block the usages of the app and show a dialog in the application to force the users to upgrade their app.</p>
<h3>Data migration</h3>
<p>It may not be a trivial task to do data migration without putting the system on maintenance mode since the users (or other systems) can still trigger to create new data or make changes to the data during data migration.
I discussed possible solutions in <a href="/2022-3-5-database-migration-with-no-downtime.mdx">my previous post</a>
If it&#x27;s too complex to do data migration when the system is still live, we can put part of the system in read-only mode during data migration.</p></div></div></div><div class="MuiBox-root css-1nevh8s"><div class="MuiContainer-root MuiContainer-maxWidthLg css-c6r19y"><p class="MuiTypography-root MuiTypography-body1 MuiTypography-paragraph css-v2arnj">© 2022 Sing Mak</p><p class="MuiTypography-root MuiTypography-body1 MuiTypography-paragraph css-3qcq41">Built with <a href="https://www.gatsbyjs.com" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-m136qf">Gatsby</a> and <a href="https://mui.com" class="MuiTypography-root MuiTypography-inherit MuiLink-root MuiLink-underlineAlways css-m136qf">MUI</a></p></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/post/2022-3-12-blue-green-deployment/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-51837b75c3eaa383a78e.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-8e778e103c99d8026125.js\"],\"component---src-pages-about-tsx\":[\"/component---src-pages-about-tsx-1b1533c63317821ad047.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-89bb8b026ab0411667d3.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2021-5-16-sqs-fifo-lambda-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2021-5-16-sqs-fifo-lambda-mdx-f9c1cfab4e68cd91c038.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2021-5-30-serverless-manage-resources-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2021-5-30-serverless-manage-resources-mdx-fed06c7e593ea630f24f.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2021-5-8-turn-express-app-to-lambda-cdk-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2021-5-8-turn-express-app-to-lambda-cdk-mdx-8db30be33c5548eba768.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-12-18-nginx-proxy-server-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-12-18-nginx-proxy-server-mdx-a17d3de424fb10262e23.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-2-13-talking-to-your-database-with-hasura-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-2-13-talking-to-your-database-with-hasura-mdx-5562a6775d3ccebb781e.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-2-27-lambda-cold-start-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-2-27-lambda-cold-start-mdx-f804a68a5ead939bf113.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-3-12-blue-green-deployment-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-3-12-blue-green-deployment-mdx-7758f1404ee2919cd209.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-3-5-database-migration-with-no-downtime-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2022-3-5-database-migration-with-no-downtime-mdx-d32127a677db5eeeccc6.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-6-10-alive-again-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-6-10-alive-again-mdx-5e41ee010ffa1af2b6ba.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-6-11-rancher-desktop-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-6-11-rancher-desktop-mdx-7d8d5c1f6979c8d87247.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-6-12-identify-the-boundaries-of-microservices-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-6-12-identify-the-boundaries-of-microservices-mdx-46c1e8821d78b56034b6.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-6-24-learned-a-few-things-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-6-24-learned-a-few-things-mdx-d8aef6cb667186f05235.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-7-2-aws-rds-lesson-learnt-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-7-2-aws-rds-lesson-learnt-mdx-c93ff823c246b97e2c2a.js\"],\"component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-7-24-handling-related-data-microservice-mdx\":[\"/component---src-pages-post-mdx-fields-slug-tsx-content-file-path-posts-2023-7-24-handling-related-data-microservice-mdx-b126491c6fef5c950cb3.js\"],\"component---src-pages-tags-tsx\":[\"/component---src-pages-tags-tsx-2226e7404a3904bf5875.js\"],\"component---src-templates-tag-tsx\":[\"/component---src-templates-tag-tsx-b2a5fd0d87b3802a3d32.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="93936974d6145f64767e";</script><script src="/webpack-runtime-09159b6a2737f5f3474b.js" async></script><script src="/framework-59ae4113612e286a204c.js" async></script><script src="/app-51837b75c3eaa383a78e.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>